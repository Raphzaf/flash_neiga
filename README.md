# Flash Neiga - Driving Test Preparation App

A comprehensive web application for preparing for driving theory exams, featuring a React frontend and FastAPI backend.

## üèóÔ∏è Project Structure

```
flash_neiga/
‚îú‚îÄ‚îÄ backend/          # FastAPI backend application
‚îÇ   ‚îú‚îÄ‚îÄ server.py     # Main FastAPI application
‚îÇ   ‚îú‚îÄ‚îÄ database.py   # Database configuration (SQLite)
‚îÇ   ‚îú‚îÄ‚îÄ models.py     # Data models
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ frontend/         # React frontend application
‚îú‚îÄ‚îÄ data/            # Sample questions and data
‚îî‚îÄ‚îÄ render.yaml      # Render deployment configuration
```

## üöÄ Deployment

### Backend Deployment on Render

The backend is configured to deploy on Render using the `render.yaml` configuration file.

#### Prerequisites

1. A Render account ([sign up here](https://render.com))
2. GitHub repository connected to Render

#### Deployment Steps

1. **Connect Repository to Render**
   - Go to [Render Dashboard](https://dashboard.render.com)
   - Click "New +" and select "Blueprint"
   - Connect your GitHub repository
   - Select the `flash_neiga` repository

2. **Render will automatically detect `render.yaml`**
   - The configuration includes:
     - Web service: `flash-neiga-backend`
     - Python environment (3.11)
     - Persistent disk for SQLite database (1GB)
     - Auto-generated SECRET_KEY

3. **Set Environment Variables** (Optional)
   
   The following environment variables can be configured in Render Dashboard:
   
   - `SECRET_KEY` - Auto-generated by Render (or set your own)
   - `PYTHON_VERSION` - Set to "3.11" (default)
   - `DATABASE_URL` - Set to `sqlite:///./flash_neiga.db` (default)
   - `ALLOWED_ORIGINS` - Comma-separated list of allowed frontend URLs (e.g., `https://your-frontend.netlify.app,http://localhost:3000`)
   - `ADMIN_TOKEN` - (Optional) Token for admin endpoints
   - `STRIPE_SECRET_KEY` - (Optional) For payment integration

4. **Deploy**
   - Click "Apply" to start deployment
   - Wait for build and deployment to complete
   - Your API will be available at: `https://flash-neiga-backend.onrender.com`

#### Health Check

The backend includes a health check endpoint at `/health` that Render uses to monitor service status:

```bash
curl https://flash-neiga-backend.onrender.com/health
```

Expected response:
```json
{
  "status": "healthy",
  "service": "flash-neiga-backend",
  "timestamp": "2025-12-14T00:00:00.000000+00:00"
}
```

#### Optional: Switching to PostgreSQL

For better production reliability, you can switch from SQLite to PostgreSQL:

1. **Update render.yaml**:
   - Uncomment the `databases` section at the bottom
   - Comment out the `disk` section
   - Update the `DATABASE_URL` environment variable to use `fromDatabase`

2. **Update requirements.txt**:
   - Uncomment `psycopg2-binary>=2.9.9`

3. **Redeploy**:
   - Push changes to trigger a new deployment
   - The database will be automatically provisioned

The backend will automatically use PostgreSQL when `DATABASE_URL` is set, falling back to SQLite for local development.

### Frontend Deployment on Netlify

The frontend can be deployed on Netlify or any static hosting service.

#### Environment Variables for Frontend

Set the following environment variable in your Netlify deployment:

- `REACT_APP_API_URL` - Your backend API URL (e.g., `https://flash-neiga-backend.onrender.com`)

## üíª Local Development

### Backend Setup

1. **Navigate to backend directory**
   ```bash
   cd backend
   ```

2. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

3. **Run the server**
   ```bash
   # Development
   python server.py
   
   # Or with uvicorn directly
   uvicorn server:app --reload --host 0.0.0.0 --port 8000
   ```

4. **Access the API**
   - API: http://localhost:8000
   - API Documentation: http://localhost:8000/docs
   - Health Check: http://localhost:8000/health

### Frontend Setup

1. **Navigate to frontend directory**
   ```bash
   cd frontend
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Run development server**
   ```bash
   npm start
   ```

4. **Access the application**
   - Frontend: http://localhost:3000

## üîß Configuration

### Database

The backend uses SQLite for data persistence. The database file (`flash_neiga.db`) is stored in the `backend/` directory.

For production on Render, the SQLite database is persisted using Render's disk feature:
- **Mount path**: `/opt/render/project/src/backend`
- **Size**: 1GB (free tier)

### CORS Configuration

CORS is configured to allow requests from any origin by default. For production, set the `ALLOWED_ORIGINS` environment variable:

```bash
ALLOWED_ORIGINS=https://your-frontend.netlify.app,https://your-custom-domain.com
```

## üìã API Endpoints

### Authentication
- `POST /api/auth/register` - Register new user
- `POST /api/auth/login` - Login user
- `GET /api/auth/me` - Get current user

### Questions
- `GET /api/questions` - Get all questions (with optional category filter)
- `POST /api/questions` - Create new question

### Exams
- `POST /api/exam/start` - Start new exam session
- `GET /api/exam/{exam_id}` - Get exam details
- `POST /api/exam/{exam_id}/answer` - Submit answer
- `POST /api/exam/{exam_id}/finish` - Finish exam
- `GET /api/exam/{exam_id}/details` - Get detailed exam results

### Training
- `POST /api/training/check` - Check training answer

### Stats
- `GET /api/stats/summary` - Get stats summary
- `GET /api/stats/details` - Get detailed stats

### Health
- `GET /health` - Health check endpoint

## üîê Security

- Passwords are hashed using bcrypt
- JWT tokens for authentication
- SECRET_KEY should be set in production (auto-generated by Render)
- CORS configured for production domains

## üìù License

[Add your license information here]

## ü§ù Contributing

[Add contribution guidelines here]
